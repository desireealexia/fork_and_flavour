{% extends 'base.html' %}
{% load static %}
{% block title %}{{ recipe.title }} - Fork & Flavour{% endblock %}
{% block content %}

<div class="container mt-5">
  <!-- Recipe Header -->
  <div class="row">
    <div class="col-12 d-flex justify-content-between align-items-center">
      <h1>{{ recipe.title }}</h1>

      <!-- Edit and Delete Buttons (only visible to the recipe author) -->
      {% if request.user == recipe.user %}
      <div>
        <a href="{% url 'recipe_update' recipe.slug %}" class="btn btn-warning mx-2 py-2 px-4 rounded-pill shadow-sm" data-toggle="tooltip" data-placement="top" title="Edit this recipe">
          <i class="fas fa-edit"></i> Edit
        </a>
        <a href="{% url 'recipe_delete' recipe.slug %}" class="btn btn-danger mx-2 py-2 px-4 rounded-pill shadow-sm" data-toggle="tooltip" data-placement="top" title="Delete this recipe">
          <i class="fas fa-trash-alt"></i> Delete
        </a>
      </div>
      {% endif %}
    </div>
      <p class="text-muted">Recipe by {{ recipe.user }}</p>
      <p>{{ recipe.description }}</p>
    </div>
  </div>

  <!-- Recipe Content: Photo on the Left, Ingredients on the Right -->
  <div class="row mb-4">
    <div class="col-md-4 text-center">
      {% if recipe.image %}
      <img src="{{ recipe.image.url }}" alt="{{ recipe.title }}" class="img-fluid recipe-img" />
      {% else %}
      <img src="{% static 'images/default-recipe.jpg' %}" alt="Default Recipe Image" class="img-fluid recipe-img" />
      {% endif %}
    </div>
    <div class="col-md-8">
      <h2>Ingredients</h2>
      <ul class="list-group">
        {% for ingredient in ingredients %}
        <li class="list-group-item d-flex align-items-center">
          <input type="checkbox" />
          {% if ingredient.quantity %}
          {{ ingredient.format_quantity }}
          {% endif %}
          {% if ingredient.unit %}
          {{ ingredient.unit }}
          {% endif %}
          {{ ingredient.ingredient.name }}
          {% if ingredient.is_optional %}
          <span class="text-muted">(Optional)</span>
          {% endif %}
        </li>
        {% empty %}
        <li class="list-group-item">No ingredients listed.</li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <!-- Preparation Steps Section -->
  <div class="row mt-4">
    <div class="col-12">
      <h2>Preparation Steps</h2>
      <ol>
        {{ recipe.instructions|safe }}
      </ol>
    </div>
  </div>

  <!-- Social Share Section -->
  <div class="row mt-4">
    <div class="col-12 text-center">
      <p>Share this recipe:</p>
      <div class="d-flex justify-content-center">
        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" class="btn btn-primary mx-2 rounded-pill">
          <i class="fab fa-facebook-f"></i> Facebook
        </a>
        <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text=Check%20out%20this%20delicious%20recipe!" target="_blank" class="btn btn-primary mx-2 rounded-pill">
          <i class="fab fa-twitter"></i> Twitter
        </a>
      </div>
    </div>
  </div>

</div>

{% endblock %}
